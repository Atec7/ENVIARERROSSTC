<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formul√°rio de Servi√ßo</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
      color: #333;
    }


    .direitos {
      font-size: 10px;
      text-align: center;
      padding: 5px;
      background-color: #ddd;
      color: #555;
    }

    form {
      background-color: #fff;
      padding: 30px;
      max-width: 90%;
      margin: 20px auto;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
      font-size: 14px;
    }

    textarea {
      text-transform: uppercase;
      resize: vertical;
      min-height: 80px;
    }

    button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
.CANCELAR {
      background-color: rgb(141, 3, 3);
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    .CANCELAR:hover {
      background-color: red;
    }
    button:hover {
      background-color: #218838;
    }

    .acoes {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px auto;
      justify-content: center;
      max-width: 900px;
    }

    .acoes button {
      background-color: #007bff;
    }

    .acoes button:hover {
      background-color: #0056b3;
    }

    #tabelaContainer {
      display: none;
      max-width: 95%;
      margin: 20px auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
    }

    th {
      background-color: #f1f1f1;
    }

    .input-group {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 15px;
    }

    .input-group > div {
      flex: 1 1 300px;
      min-width: 250px;
    }

    .checkbox-group {
  margin-top: 20px;
}

.checkbox-group label {
  display: block;
  font-weight: normal;
  margin-top: 5px;
  color: black;
}

.checkbox-group input[type="checkbox"] {
  transform: scale(1.5);
  margin-right: 10px;
  vertical-align: middle;
}

.NOMEDOSISTEMA{
  text-align: center;
  font-size: 26PX;
}

.info {
  font-size: 16px;
  text-align: center;
}

.Atribui√ß√µes{
  text-align: center;
  font-size: 30px;
}
  </style>
</head>
<body>


<H1 class="NOMEDOSISTEMA">REGISTRO DE N√ÉO CONFORMIDADE NA QUALIDADE DE SERVI√áOS EM STC</H1>
<p class="info">Ger√™ncia de Servi√ßos T√©cnicos e Comerciais - Informa√ß√£o e Performance</p>
  <div class="direitos">
    Arnaldo S. Lima - todos os direitos reservados
  </div>
  <form id="formulario">
    <div class="input-group">
      <div>
        <label for="ss">üóí‚öô N√öMERO DA SS:</label>
        <input type="text" id="ss" required placeholder="N√∫mero da Miscel√¢nea ou Ocorr√™ncia"/>
      </div>
      <div>
        <label for="data">üìÖ DATA E HORA DA EXECU√á√ÉO:</label>
        <input type="text" id="data" required placeholder="Obrigatoriamente padr√£o exemplo:11/03/2025 07:40 - 07:43"/>
      </div>
    </div>

    <div class="input-group">
      <div>
        <label for="equipe">üöôEQUIPE:</label>
        <input type="text" id="equipe" required placeholder="Prefixo EQTL ou Prefixo PARTNER"/>
      </div>
      <div>
        <label for="endereco">üìçENDERE√áO:</label>
        <input type="text" id="endereco" required placeholder="Endere√ßo do GPM/OPER"/>
      </div>
    </div>

    <div class="input-group">
      <div>
        <label for="coordenadas">üåè LOCAL DA EXECU√á√ÉO</label>
        <input type="text" id="coordenadas" required placeholder="Segunda linha de coordenadas do GPM ...exemplo: -18,760592	-50,940178" />
      </div>
    </div>

    <div class="input-group">
      <div>
        <label for="supervisor">SUPERVISOR:</label>
        <select id="supervisor" required>
          <option value="">Selecione</option>
          <option value="JOSE VICTOR DA SILVA COELHO">JOSE VICTOR DA SILVA COELHO</option>
          <option value="LEANDRO FREITAS AQUINO SILVA">LEANDRO FREITAS AQUINO SILVA</option>
          <option value="RODRIGO DA COSTA FERREIRA">RODRIGO DA COSTA FERREIRA</option>
          <option value="GUSTAVO SAVIANE MARTINS">GUSTAVO SAVIANE MARTINS</option>
          <option value="AC√ÅCIO SOUSA JESUS">AC√ÅCIO SOUSA JESUS</option>
          <option value="JOSE AILSON NASCIMENTO SOUTO">JOSE AILSON NASCIMENTO SOUTO</option>
        </select>
      </div>
      <div>
        <label for="strike">STRIKE:</label>
        <select id="strike" required>
          <option value="">Selecione</option>
          <option value="Strike Zero">Strike Zero</option>
          <option value="Strike 1">Strike 1</option>
          <option value="Strike 2">Strike 2</option>
          <option value="Strike 3">Strike 3</option>
          <option value="Strike 4">Strike 4</option>
          <option value="Strike 5">Strike 5</option>
        </select>
      </div>
    </div>

    <div class="input-group">
      <div>
        <label for="ordemServico">üü¢ ORDEM DE SERVI√áO:</label>
        <input type="text" id="ordemServico" required placeholder="Copia e Cola da Oredem de Execu√ß√£o do OPER"/>
      </div>
      <div>
        <label for="rejeicaoEquatorial">üî¥ MOTIVO DA REJEI√á√ÉO:</label>
        <input type="text" id="rejeicaoEquatorial" required placeholder="Copia e Cola do motivo de Rejei√ß√£o do SGT"/>
      </div>
    </div>

    <div class="checkbox-group">
      <label><b>‚¨á SERVI√áO ATRIBUIDO √Ä EQUIPE PELO C.O.I:</b></label>
      <label><input type="checkbox" name="servicos" value="OCORR√äNCIA" /><B>‚öôÔ∏èOCORR√äNCIA</B></label>
      <label><input type="checkbox" name="servicos" value="REALIZAR PODA" /><B>‚öôÔ∏èREALIZAR PODA</B></label>
      <label><input type="checkbox" name="servicos" value="INSTALA√á√ÉO DE ESPA√áADORES" /><B>‚öôÔ∏èINSTALA√á√ÉO DE ESPA√áADORES</B></label>
      <label><input type="checkbox" name="servicos" value="SUBSTITUI√á√ÉO DE ELO" /><B>‚öôÔ∏èSUBSTITUI√á√ÉO DE ELO</B></label>
      <label><input type="checkbox" name="servicos" value="SUBSTITUI√á√ÉO DE RAMAL" /><B>‚öôÔ∏èSUBSTITUI√á√ÉO DE RAMAL</B></label>
      <LABEl><input type="checkbox" name="servicos" value="LEVANTAMENTO NECESSIDADE"><B>‚öôÔ∏èLEVANTAMENTO NECESSIDADE</B></LABEl>
    </div>
<BR>
</BR>
    <div>
      <label for="problema">üü† ORIENTA√á√ÉO I&P PARA RECUPERA√á√ÉO DO SERVI√áO:</label>
      <textarea id="problema" required placeholder= "üö®OBRIGAT√ìRIO O N√öMERO DO POSTE! üö®üö®OBRIGAT√ìRIO O N√öMERO DO POSTE! üö®üö®OBRIGAT√ìRIO O N√öMERO DO POSTE! üö®"></textarea>
    </div>

    <button type="submit"> SOLICITAR RETRABALHO ü™É</button>
    <button class="CANCELAR" type="submit" onclick="location.reload()">CANCELAR O RETRABALHO ‚ùå</button>

    <button onclick="toggleTabela()">Mostrar/Ocultar Registros</button>
    <button onclick="limparTabela()">Limpar Registros</button>
    <button onclick="exportarExcel()">Exportar Excel</button>
  </form>

  <div id="tabelaContainer">
    <h3 class="Atribui√ß√µes">‚¨á Minhas Atribui√ß√µes ‚¨á</h3>
    <table id="tabelaRegistros">
      <thead>
        <tr>
          <th>SS</th>
          <th>Data</th>
          <th>Equipe</th>
          <th>Endere√ßo</th>
          <th>Local da Execu√ß√£o</th>
          <th>Supervisor</th>
          <th>Strike</th>
          <th>Servi√ßos</th>
          <th>Problema</th>
          <th>Ordem de Servi√ßo</th>
          <th>Rejei√ß√£o da Equatorial</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
  const form = document.getElementById("formulario");
  const tabela = document.getElementById("tabelaRegistros").querySelector("tbody");
  const tabelaContainer = document.getElementById("tabelaContainer");

  const numeros = {
    "JOSE VICTOR DA SILVA COELHO": "5564999056674",
    "LEANDRO FREITAS AQUINO SILVA": "5564999536838",
    "RODRIGO DA COSTA FERREIRA": "5564996107854",
    "GUSTAVO SAVIANE MARTINS": "5564981138729",
    "AC√ÅCIO SOUSA JESUS": "5564999777925",
    "JOSE AILSON NASCIMENTO SOUTO": "5562999099920"
  };

  document.getElementById("coordenadas").addEventListener("blur", function () {
    const raw = this.value.replace(/[()]/g, "").replace(/,/g, '.').trim();
    const partes = raw.split(/\s+/);

    if (partes.length === 2 && !isNaN(partes[0]) && !isNaN(partes[1])) {
      const lat = partes[0];
      const lng = partes[1];
      const url = `https://www.google.com/maps?q=${lat},${lng}`;
      this.value = url;
    }
  });

  function salvarLocalStorage(registros) {
    localStorage.setItem("registros_servico", JSON.stringify(registros));
  }

  function carregarLocalStorage() {
    const dados = localStorage.getItem("registros_servico");
    return dados ? JSON.parse(dados) : [];
  }

  function atualizarTabela() {
    tabela.innerHTML = "";
    const registros = carregarLocalStorage();
    registros.forEach(item => {
      const linha = tabela.insertRow();
      Object.values(item).forEach(valor => {
        linha.insertCell().textContent = valor;
      });
    });
    tabelaContainer.style.display = registros.length > 0 ? "block" : "none";
  }

  form.addEventListener("submit", function(e) {
    e.preventDefault();

    const ss = document.getElementById("ss").value.trim();
    const data = document.getElementById("data").value.trim();
    const equipe = document.getElementById("equipe").value.trim();
    const endereco = document.getElementById("endereco").value.trim();
    const coordenadas = document.getElementById("coordenadas").value.trim();
    const supervisor = document.getElementById("supervisor").value;
    const strike = document.getElementById("strike").value;
    const problema = document.getElementById("problema").value.trim().toUpperCase();
    const servicos = Array.from(document.querySelectorAll('input[name="servicos"]:checked')).map(el => el.value).join(", ");
    const ordemServico = document.getElementById("ordemServico").value.trim();
    const rejeicaoEquatorial = document.getElementById("rejeicaoEquatorial").value.trim();

    const novoRegistro = { ss, data, equipe, endereco, coordenadas, supervisor, strike, servicos, problema, ordemServico, rejeicaoEquatorial };
    const registros = carregarLocalStorage();
    registros.push(novoRegistro);
    salvarLocalStorage(registros);
    atualizarTabela();

    const numero = numeros[supervisor] || "5564996151084";
    const mensagem = `
üö® SERVI√áO CORRE O RISCO DE N√ÉO SER PAGO PELA EQUATORIAL üö®

*SS:* ${ss}
*DATA:* ${data}
*EQUIPE:* ${equipe}
*ENDERE√áO:* ${endereco}
*LOCAL EXECU√á√ÉO:* ${coordenadas}
*SUPERVISOR:* ${supervisor}
*STRIKE:* ${strike}
*SERVI√áO ATRIBUIDO:* ${servicos}
*ORIENTA√á√ÉO I&P:* ${problema}
*ORDEM SERVI√áO:* ${ordemServico}
*MOTIVO REJEI√á√ÉO EQTL:* ${rejeicaoEquatorial}

*O registro das evid√™ncias deve ser feito no link abaixo:*
*https://forms.office.com/r/XNfkN9UhY1*

*POR FAVOR ORIENTAR ESTA EQUIPE PARA EVITAR MAIS RETRABALHOS.*

 _As evid√™ncias s√£o t√£o importantes quanto a execu√ß√£o do servi√ßo!_`;

    form.reset();
    setTimeout(() => {
      window.open(`https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`, '_blank');
    }, 300);
  });

  function toggleTabela() {
    tabelaContainer.style.display = tabelaContainer.style.display === "none" ? "block" : "none";
  }

  function limparTabela() {
    if (confirm("Tem certeza que deseja apagar todos os registros? üö®A√á√ÉO N√ÉO ACONSELHADA!!!")) {
      localStorage.removeItem("registros_servico");
      tabela.innerHTML = "";
      tabelaContainer.style.display = "none";
    }
  }

  function exportarExcel() {
    let html = "<table><tr><th>SS</th><th>Data</th><th>Equipe</th><th>Endere√ßo</th><th>Coordenadas</th><th>Supervisor</th><th>Strike</th><th>Servi√ßos</th><th>Problema</th><th>Ordem de Servi√ßo</th><th>Rejei√ß√£o da Equatorial</th></tr>";
    for (const row of tabela.rows) {
      html += "<tr>";
      for (const cell of row.cells) {
        html += `<td>${cell.innerText}</td>`;
      }
      html += "</tr>";
    }
    html += "</table>";

    const blob = new Blob([html], { type: "application/vnd.ms-excel" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "registros.xls";
    a.click();
  }

  window.addEventListener("DOMContentLoaded", atualizarTabela);
</script>
</body>
</html>
